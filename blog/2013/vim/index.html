<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    
    <!-- Website verification -->
    <meta name="google-site-verification" content="xRlThgNzCzfRY8XKsahsru2gLV-Cc284pbsdHHnr2oY">
<meta name="msvalidate.01" content="">
<!-- Avoid warning on Google Chrome
        Error with Permissions-Policy header: Origin trial controlled feature not enabled: 'interest-cohort'.
        see https://stackoverflow.com/a/75119417
    -->
    <meta http-equiv="Permissions-Policy" content="interest-cohort=()">

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Vim, Ctags and Cscope | Saurav  Kumar</title>
    <meta name="author" content="Saurav  Kumar">
    <meta name="description" content="">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="/assets/img/pcb.jpg">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://k45v.github.io/blog/2013/vim/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Saurav </span>Kumar</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/cv/">cv</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Vim, Ctags and Cscope</h1>
    <p class="post-meta">April 20, 2013</p>
       
  </header>

  <article class="post-content">
    
    <div id="markdown-content">
      <p>You have been given a project folder with the code spread over multiple files (maybe even nested in sub-folders). Now, you wish to add a new feature to this project. But before you can start scribbling down your algorithm and making changes, you need to understand the code. Vim coupled with Ctags and Cscope can help you do exactly that. Ctags helps you jump from function/symbol instances to their definitions and Cscope does the opposite i.e. you can see the entire call hierarchy of a particular function (where all the function is called). The tutorials for setting up Cscope were a bit tricky and I wanted to document my set of steps here. So here is how to set up your tools:</p>

<ol>
  <li>The Vim editor<br>
Install using:
    <div class="language-shell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>vim
</code></pre></div>    </div>
    <p>I am assuming you know how to use vim. If not then there are plenty of tutorials on the internet to get you started with vim.</p>
  </li>
  <li>Ctags
    <div class="language-shell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>exuberant-ctags
</code></pre></div>    </div>
    <p>After installing ctags, navigate inside the project folder and do</p>
    <div class="language-shell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>ctags <span class="nt">-R</span> ./<span class="k">*</span>
</code></pre></div>    </div>
    <p>This will generate tags (they help you find the function definitions from their instances) for your entire code. Now from this same directory (do not change your directory), open a code file in vim</p>
    <div class="language-shell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>vim ./main.c
</code></pre></div>    </div>
    <p>Say inside your main code you see a call to function “calculate” which is defined in some other file in your current folder (or sub-folder). Then move your cursor over “calculate” and press the CTRL; while keeping CTRL pressed hit ] key. You’ll find yourself in the function definition of “calculate”. We’ll call this pressing of CTRL and then ] key while holding CTRL down as CTRL+]. To go back use CTRL+t.</p>
  </li>
  <li>Cscope<br>
Install cscope
    <div class="language-shell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>cscope
</code></pre></div>    </div>
    <p>Now open/create a “.vimrc” file in you home directory using:</p>
    <div class="language-shell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>vim ~/.vimrc
</code></pre></div>    </div>
    <p>Append the following in this file</p>
    <div class="language-shell highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">if </span>has<span class="o">(</span><span class="s2">"cscope"</span><span class="o">)</span>
    <span class="nb">set </span><span class="nv">csprg</span><span class="o">=</span>/usr/bin/cscope
    <span class="nb">set </span><span class="nv">csto</span><span class="o">=</span>0
    <span class="nb">set </span>cst
    <span class="nb">set </span>nocsverb
    <span class="s2">" add any database in current directory
        if filereadable("</span>cscope.out<span class="s2">")
                cs add cscope.out
                        "</span> <span class="k">else </span>add database pointed to by environment
                            elseif <span class="nv">$CSCOPE_DB</span> <span class="o">!=</span> <span class="s2">""</span>
        cs add <span class="nv">$CSCOPE_DB</span>
    endif
endif
   
nmap &lt;C-<span class="se">\&gt;</span>s :cs find s <span class="o">=</span><span class="nb">expand</span><span class="o">(</span><span class="s2">""</span><span class="o">)</span>
nmap &lt;C-<span class="se">\&gt;</span>g :cs find g <span class="o">=</span><span class="nb">expand</span><span class="o">(</span><span class="s2">""</span><span class="o">)</span>
nmap &lt;C-<span class="se">\&gt;</span>c :cs find c <span class="o">=</span><span class="nb">expand</span><span class="o">(</span><span class="s2">""</span><span class="o">)</span>
nmap &lt;C-<span class="se">\&gt;</span>t :cs find t <span class="o">=</span><span class="nb">expand</span><span class="o">(</span><span class="s2">""</span><span class="o">)</span>
nmap &lt;C-<span class="se">\&gt;</span>e :cs find e <span class="o">=</span><span class="nb">expand</span><span class="o">(</span><span class="s2">""</span><span class="o">)</span>
nmap &lt;C-<span class="se">\&gt;</span>f :cs find f <span class="o">=</span><span class="nb">expand</span><span class="o">(</span><span class="s2">""</span><span class="o">)</span>
nmap &lt;C-<span class="se">\&gt;</span>i :cs find i ^<span class="o">=</span><span class="nb">expand</span><span class="o">(</span><span class="s2">""</span><span class="o">)</span><span class="err">$</span>
nmap &lt;C-<span class="se">\&gt;</span>d :cs find d <span class="o">=</span><span class="nb">expand</span><span class="o">(</span><span class="s2">""</span><span class="o">)</span>
   
<span class="nb">set </span>nohlsearch
</code></pre></div>    </div>
  </li>
</ol>

<p>In your code folder do</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cscope <span class="nt">-Rb</span>
</code></pre></div></div>
<p>Open a file, say main.c and take your cursor on a function name and press CTRL; while holding down CTRL press \ key, now release both and hit c. So the combo will be CTRL+\ (release both) c. It should now show you where all this function has been called. If the list is long, hit q and type the number where you want to go. To return from here use CTRL+t.
In order to look for a symbol (variable name) use the combo CTRL+\ (release both) s. You can make out the other combos from the nmap statements in the .vimrc file.</p>

<p>These tools can prove to be extremely useful in case you are working on a server or a machine with limited resources. Alternatively you can use Eclipse with the CDT bundle.</p>

<p>If you wish to use Eclipse with the CDT bundle to explore/edit code which is on a remote system then you can mount the remote directory using the command:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sshfs login@remote.server.ip:/path/to/remote/directory /path/to/local/directory/or/mount/point
fusermount <span class="nt">-u</span> /path/to/mount/point/for/unmounting
</code></pre></div></div>
<p>Another alternative to access remote files using eclipse would be to install the Eclipse RSE plugin. For this, simply search for eclipse RSE and download the latest stable release. Copy the contents of features and plugins directory into corresponding eclipse folder (eclipse installation folder in windows and .eclipse folder at linux home). Launch eclipse now and then Window -&gt; Show view -&gt; Other -&gt; Remote systems -&gt; remote systems. Right click local and select New -&gt; connection. Enter IP, select ssh.files, processes.shell.linux, ssh.shells, ssh.terminals. Finish. Select sftp files, My Home. Enter password when prompted! Voila, you can now access files over network. What’s more, you can right click ssh terminals and select launch terminal within eclipse to compile/test your code.</p>

<h2 id="appendix">Appendix</h2>

<p>My Vim cheat sheet:
This is a list of commands which I most frequently use on vim</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>i to insert
:wq save and quit
:tabe path/filename to open in new tab
:set mouse =a to use mouse
:tabn or :tabp to move between tabs or simply click
:wa save all open tabs
/string to search
gg move to top
GG move to bottom
A append at end of line
yy copy/yank one line
y3 copy 3lines
p paste at end of current line
Cut a section of words:- v to begin selecting, d to end and cut, p to paste
</code></pre></div></div>

    </div>
  </article>
  <p class="post-tags">
    <a href="/blog/2013"> <i class="fas fa-calendar fa-sm"></i> 2013 </a>
      ·  
    <a href="/blog/category/linux">
      <i class="fas fa-tag fa-sm"></i> Linux</a>
    
  </p>

</div>

    </div>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
